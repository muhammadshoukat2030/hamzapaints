<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Sale Bill | Hamza Paints</title>
  <link rel="icon" href="/images/weldon-paints-logo.png" type="image/png">
  <link rel="stylesheet" href="/stylesheets/printSales.css">
</head>

<body>
  <div class="print-area">

    <div class="shop-header">
      <img src="/images/weldon-paints-logo.png" id="logo">
      <div class="shop-name-en">
        Hamza Weldon Paint & Hardware Store
      </div>
      <div class="shop-name-ur">
        حمزہ ویلڈن پینٹ اینڈ ہارڈویئر سٹور
      </div>
      <div class="shop-phones">
        <span dir="ltr">0319-9303154</span>(حمزہ)
        <span dir="ltr">0332-9780911</span>(اسماعیل)
        <span dir="ltr">0335-0502041</span>(مبارک شاہ)
      </div>
      <br><br>
      <div class="divider-line">------------------------------------ کسٹمر نام </div>
    </div>
    <p><b>Entry date:</b> <%= currentDate %></p>

    <h3>Remarks:</h3>

    <table>
      <thead>
        <tr>
          <th>Stock ID</th>
          <th>Sale ID</th>
          <th>Item</th>
          <th>Color</th>
          <th>Unit</th>
          <th>Qty</th>
          <th>Price</th>
          <th>Total</th>
        </tr>
      </thead>
      <tbody id="billTableBody">
        </tbody>
    </table>

    <div class="footer">
      <span id="billTotalItems">Total items: 0</span>
      <span id="billTotalAmount">Total amount: Rs 0.00</span>
    </div>

    <div class="urdu-footer">
      پتہ: ملک تاج مارکیٹ، دکان نمبر 5،6 کوہاٹ بورڈ ہائی وے چوک
    </div>

    <div class="urdu-warning">
      .بل کے بغیر واپسی نہیں ہوگی
    </div>
    <div class="thank-you-section">
      THANK YOU FOR VISITING HAMZA PAINTS
    </div>

    <div class="dev-footer">
      <span>Software Developed by: M.SHOUKAT (0335 8004900)</span><br>
    </div>

  </div>

  <script>
    document.addEventListener("DOMContentLoaded", function () {
      // 1. LocalStorage se sales data nikaalna
      const savedData = localStorage.getItem("lastAddedSales");
      const tbody = document.getElementById("billTableBody");
      const totalItemsSpan = document.getElementById("billTotalItems");
      const totalAmountSpan = document.getElementById("billTotalAmount");

      if (savedData) {
        const sales = JSON.parse(savedData);
        let tableHTML = "";
        let totalAmount = 0;

        // 2. Loop chala kar rows banana
        sales.forEach(s => {
          const rowTotal = parseFloat((s.quantitySold * s.rate).toFixed(2));
          totalAmount += rowTotal;

          tableHTML += `
            <tr>
              <td>${s.stockID}</td>
              <td>${s.saleID}</td>
              <td>${s.itemName}</td>
              <td>${s.colourName}</td>
              <td>${s.qty }</td>
              <td>${s.quantitySold}</td>
              <td>Rs ${parseFloat(s.rate).toFixed(2)}</td>
              <td>Rs ${rowTotal.toFixed(2)}</td>
            </tr>`;
        });

        // 3. UI update karna
        tbody.innerHTML = tableHTML;
        totalItemsSpan.innerText = `Total items: ${sales.length}`;
        totalAmountSpan.innerText = `Total amount: Rs ${totalAmount.toFixed(2)}`;


      } else {
        tbody.innerHTML = `<tr><td colspan="8" style="text-align:center;">No bill data found to print</td></tr>`;
      }
    });
  </script>
</body>
</html>

